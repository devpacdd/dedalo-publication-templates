const config={api_server_url:"https://dedalo.dev/dedalo/lib/dedalo/publication/server_api/v1/json/",api_code:"7Yd8jdyf_duen327!udjx",api_db_name:"web_dedalo_demo_dev",media_base_url:"https://dedalo.dev",table_menu:"ts_web",table_menu_filter:"menu='yes'",langs:[{code:"lg-spa",label:"Espa√±ol"},{code:"lg-eng",label:"English"}],lang_default:"lg-eng",thesaurus_tables:["ts_anthropology"],thesaurus_root_terms:["aa1_1"],version:"0.0.1"},environment=config;environment.lang=localStorage.getItem("lang")||environment.lang_default;var page={page_title:null,menu_data:null,row:null,area_name:null,init:function(){const e=this;return new Promise((function(n){e.area_name=window.location.pathname.split("/").slice(1).pop()||"main_home";const t=document.getElementById("template"),a=["./common/app_utils-min.js"],o=[];for(let e=0;e<a.length;e++)o.push(new Promise((function(n,t){const o=document.createElement("script");o.src=a[e]+"?"+environment.version,o.addEventListener("load",(function(){n(!0)})),document.head.appendChild(o)})));Promise.all(o).then((function(){e.load_ts_web_data().then((function(a){e.menu_data=a,e.menu_data&&(e.row=e.menu_data.find((function(n){return n.web_path===e.area_name})),e.row?e.render_template(t).then((function(e){t.appendChild(e)})):console.error("ERROR 404: page '"+area_name+"' not found! Available pages (web_path):",e.menu_data.map(e=>e.web_path))),n(!0)}))}))}))},render_lang_selector:function(){const e=environment.langs,n=environment.lang,t=document.createElement("ul");t.classList.add("lang_selector");for(let a=0;a<e.length;a++){const o=e[a],l=document.createElement("li");t.appendChild(l);const r=document.createElement("a");r.insertAdjacentHTML("afterbegin",o.label),o.code===n&&r.classList.add("selected"),r.addEventListener("click",(function(e){e.preventDefault(),localStorage.setItem("lang",o.code),location.reload()})),l.appendChild(r)}return t},load_ts_web_data:function(){const e=this;return new Promise((function(n){const t={dedalo_get:"records",table:environment.table_menu,ar_fields:["*"],sql_filter:environment.table_menu_filter||null,limit:0,count:!1,offset:0,order:"norder ASC"};data_manager.request({body:t}).then((function(t){e.parse_ts_web_data(t.result);n(t.result)}))}))},parse_ts_web_data:function(e){if(e)for(let n=e.length-1;n>=0;n--){const t=e[n];t.children=t.children?JSON.parse(t.children):null,t.web_path=t.web_path?t.web_path:t.term_id}return e},render_menu:function(){const e=this,n=document.createElement("ul");function t(e){const t=document.createElement("li");if(t.parent_term_id=e.parent,t.term_id=e.term_id,n.appendChild(t),"yes"===e.active){const n=document.createElement("a");n.insertAdjacentHTML("afterbegin",e.term),n.href=e.web_path,t.appendChild(n)}return t}n.classList.add("menu");const a=[];for(let n=0;n<e.menu_data.length;n++){const o=e.menu_data[n];if("yes"===o.menu){const e=t(o);a.push(e)}}for(let e=0;e<n.childNodes.length;e++){const t=n.childNodes[e];if(t.parent_term_id&&t.parent_term_id.length>0){const e=a.find((function(e){return e.term_id===t.parent_term_id}));if(e){(e.lastChild&&"UL"===e.lastChild.tagName?e.lastChild:function(){const n=document.createElement("ul");return n.classList.add("menu","icon","fa-angle-down"),e.appendChild(n),n}()).appendChild(t)}}}return n},render_template:function(e){const n=this;return new Promise((function(t){const a=n.row.template_name;n.load_template_files(a).then((function(o){const l=window[a];l.init({row:n.row}).then((function(n){const a=l.render();a&&e.appendChild(a),t(a)}))}))}))},load_template_files:function(e){return new Promise((function(n){const t=["./tpl/"+e+"/css/"+e+".css"],a=document.getElementsByTagName("head")[0];for(let e=0;e<t.length;e++){const n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=t[e]+"?"+environment.version,a.appendChild(n)}const o=["./tpl/"+e+"/js/"+e+".js"],l=[];for(let e=0;e<o.length;e++)l.push(new Promise((function(n,t){const a=document.createElement("script");a.src=o[e]+"?"+environment.version,a.addEventListener("load",(function(){n(!0)})),document.head.appendChild(a)})));Promise.all(l).then(()=>{n(!0)})}))},get_posterframe_from_video:function(e){let n=e;n=n.replace(/\/404\//g,"/posterframe/"),n=n.replace(/\.mp4/g,".jpg");const t=n.split("?");return void 0!==t[0]&&(n=t[0]),n}};